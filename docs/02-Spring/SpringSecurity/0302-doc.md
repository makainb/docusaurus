---
draft: true
sidebar_class_name: hidden-sidebar-item
---

这是一个非常棒的写作计划！Spring Security 6（配合 Spring Boot 3）确实发生了巨大的变化，尤其是完全废弃了 `WebSecurityConfigurerAdapter`，全面拥抱 Lambda DSL 和组件化配置。

为了让这套教程**“由浅入深、逻辑连贯、适合新手但也能满足架构师需求”**，我将你的目录重新编排为 **六大篇章（共45篇）**。

我补充了**微服务网关集成**、**测试**、**监控**以及**更多实战场景（如社交登录、多租户）**，并详细列出了每篇的核心知识点。

---

### 📘 第一篇：核心基础篇（筑基）

> **目标**：从零开始，掌握 Security 的核心架构，学会基本的单体应用防护。

* **01. 开篇入门 - Hello Security**
* 知识点：Spring Security 的核心功能（认证 vs 授权）、Spring Boot 3 快速集成、默认的登录页与 User 生成原理。


* **02. 配置新范式 - Lambda DSL 与 SecurityFilterChain**
* 知识点：**彻底告别 `WebSecurityConfigurerAdapter**`，理解 `SecurityFilterChain` Bean 的配置方式，Lambda 表达式写法（`.authorizeHttpRequests(auth -> ...)`）。


* **03. 用户认证 - 基于数据库的 UserDetailsService**
* 知识点：`UserDetails` 接口详解、`UserDetailsService` 实现、`PasswordEncoder`（BCrypt）加密机制。


* **04. 认证原理 - 过滤器链与架构剖析**
* 知识点：`DelegatingFilterProxy`、`FilterChainProxy`、核心过滤器顺序、`AuthenticationManager` 与 `Provider` 的关系。（这是面试重点，也是理解后续自定义的基础）。


* **05. 登录定制 - 自定义登录页面与参数**
* 知识点：自定义 HTML 登录页、处理 `loginProcessingUrl`、自定义用户名/密码参数名、静态资源放行。


* **06. 登录结果 - 成功与失败的处理器**
* 知识点：`AuthenticationSuccessHandler` 与 `AuthenticationFailureHandler` 的实现（JSON 响应 vs 页面跳转）。


* **07. 权限控制 - 基于请求路径的授权 (RBAC)**
* 知识点：`requestMatchers` 的使用、`hasRole` vs `hasAuthority`、AntPathRequest 匹配规则、动态权限配置思路。


* **08. 异常处理 - 拒绝访问与未登录处理**
* 知识点：`AuthenticationEntryPoint`（未登录）、`AccessDeniedHandler`（无权限）的自定义实现。


* **09. 会话管理 - Session 策略与并发控制**
* 知识点：Session 超时设置、并发登录限制（踢掉前一个用户）、防止 Session 固定攻击。


* **10. 常见攻击防护 - CSRF 与 CORS 详解**
* 知识点：CSRF 令牌机制与启用/禁用场景、CORS（跨域）的配置与原理（后端解决跨域的最佳实践）。



---

### 🚀 第二篇：前后端分离与 JWT 篇（进阶）

> **目标**：脱离 Session/Cookie，掌握现代互联网应用最主流的无状态认证模式。

* **11. 架构演进 - 前后端分离认证方案设计**
* 知识点：Session 模式的局限性、Token 认证机制优势、Stateless（无状态）配置。


* **12. 令牌核心 - JWT (JSON Web Token) 原理与工具类**
* 知识点：JWT 结构（Header/Payload/Signature）、对称加密 vs 非对称加密（RSA）、Hutool 或 jjwt 库封装。


* **13. 过滤器实战 - 自定义 JWT 认证过滤器**
* 知识点：`OncePerRequestFilter` 实现、解析 Header 中的 Token、构建 `SecurityContext`、手动触发认证。


* **14. 多模态认证 - 集成图形验证码**
* 知识点：验证码生成与存储（Redis）、自定义 Filter 校验验证码、校验失败异常抛出。


* **15. 多模态认证 - 手机短信验证码登录**
* 知识点：自定义 `AbstractAuthenticationProcessingFilter`、自定义 `AuthenticationProvider`、多 Provider 共存原理。


* **16. 方法级安全 - 注解控制权限**
* 知识点：`@EnableMethodSecurity`、`@PreAuthorize`、`@PostAuthorize`、SpEL 表达式在权限中的应用。



---

### 🌐 第三篇：OAuth2 客户端篇（连接）

> **目标**：不仅自己做认证，还要学会“连接”微信、GitHub 等第三方平台。

* **17. OAuth2 协议 - 四种模式与核心概念详解**
* 知识点：授权码模式、客户端模式、隐式模式（已废弃）、密码模式（已废弃）、Client、Resource Owner、Authorization Server。


* **18. 快速上手 - Spring Security OAuth2 Client 集成**
* 知识点：`oauth2-client` 依赖、`application.yml` 配置 Provider（GitHub/Google）。


* **19. 社交登录 - 实现 GitHub/Gitee 第三方登录**
* 知识点：CommonOAuth2Provider、注册 Client ID、回调地址处理、获取用户信息。


* **20. 源码分析 - OAuth2ClientAuthenticationFilter 原理**
* 知识点：`OAuth2LoginAuthenticationFilter`、`OAuth2AuthorizedClientService`、Token 的保存与传递。



---

### 🔐 第四篇：OAuth2 授权服务器篇（核心 - SAS）

> **目标**：基于 Spring Authorization Server (SAS) 搭建企业级认证中心。

* **21. SAS 开篇 - 搭建最简单的授权服务器**
* 知识点：`spring-boot-starter-oauth2-authorization-server` 依赖、默认配置、生成 JWK Source。


* **22. 核心配置 - RegisteredClientRepository 详解**
* 知识点：基于内存的客户端注册、Client ID/Secret、Redirect URI、Scope、授权模式配置。


* **23. 持久化 - 基于数据库管理客户端与授权信息**
* 知识点：JdbcTemplate 集成、SAS 官方表结构（`oauth2_registered_client`、`oauth2_authorization`）解析。


* **24. 流程实战 - 完整演示授权码模式 (Authorization Code)**
* 知识点：浏览器交互流程、Postman 演示获取 Code、换取 Token。


* **25. 页面定制 - 自定义授权确认页 (Consent Page)**
* 知识点：替换默认的 Consent 页面、获取 Scope 描述、用户确认授权逻辑。


* **26. 页面定制 - 自定义统一登录页**
* 知识点：将 SAS 默认登录页替换为自己的 Vue/Thymeleaf 页面、统一认证中心 UI。


* **27. 令牌增强 - 自定义 Token 内容 (Claims)**
* 知识点：`OAuth2TokenCustomizer`、在 JWT 中注入用户 ID、部门、角色等业务数据。


* **28. 高级模式 - 客户端模式与刷新 Token**
* 知识点：Client Credentials 模式（微服务间调用）、Refresh Token 流程与配置。


* **29. OIDC 1.0 - 身份认证与 UserInfo 端点**
* 知识点：ID Token 解析、`oidc` Scope、OIDC 协议与 OAuth2 的区别、开启 UserInfo Endpoint。


* **30. 异常响应 - 自定义授权服务器异常处理**
* 知识点：处理 Client 认证失败、Scope 错误、返回符合业务规范的 JSON 格式。



---

### 🛡️ 第五篇：OAuth2 资源服务器篇（守护）

> **目标**：保护后端 API，验证 SAS 发发的 Token。

* **31. 资源服务器 - 快速集成与 JWT 校验**
* 知识点：`oauth2-resource-server` 依赖、配置 JWK Set Uri、验证 Token 签名。


* **32. 权限映射 - 详解 JwtAuthenticationConverter**
* 知识点：**核心章节**。如何将 Token 里的 `SCOPE_read` 或自定义 Claims 转换成 Security 的 `ROLE_admin` 权限。


* **33. 令牌内省 - Opaque Token (不透明令牌) 处理**
* 知识点：非 JWT 令牌处理、`introspection-uri` 配置、远程调用授权服务器校验 Token。


* **34. 多维隔离 - 资源服务器的多租户支持**
* 知识点：根据 Issuer 区分不同租户、动态加载 JWK Source。



---

### ⚡ 第六篇：高级特性与微服务架构篇（专家）

> **目标**：解决复杂场景问题，集成微服务网关，掌握最新安全标准。

* **35. 移动端安全 - PKCE 流程详解与实战**
* 知识点：Proof Key for Code Exchange 原理、防止授权码拦截攻击、前端（App/SPA）如何生成 Code Challenge。


* **36. 设备授权 - Device Code 模式 (智能家居/TV)**
* 知识点：设备码模式流程、双设备交互（电视显示码，手机扫码授权）。


* **37. 令牌新特性 - Token Exchange (令牌交换)**
* 知识点：RFC 8693、微服务链路中 Token 的传递与降级（User Token -> Service Token）。


* **38. 双向认证 - TLS 客户端认证 (mTLS)**
* 知识点：X.509 证书认证、绑定证书到 Token (Sender Constrained Access Tokens)。


* **39. 网关集成 - Spring Cloud Gateway + OAuth2**
* 知识点：**企业级重点**。在网关层做统一认证（GlobalFilter）、TokenRelay（令牌中继）到下游微服务。


* **40. 响应式编程 - WebFlux 下的 Security**
* 知识点：`ReactiveSecurityFilterChain`、Reactor Context 中的认证信息获取、WebFlux 资源服务器配置。


* **41. 令牌生命周期 - Token 撤销 (Revocation)**
* 知识点：实现注销功能、调用 Revocation Endpoint 作废 Access/Refresh Token。


* **42. 监控与审计 - Security 事件监听**
* 知识点：`AuthenticationEventPublisher`、记录登录成功/失败日志、审计合规。


* **43. 单元测试 - Security 测试支持**
* 知识点：`@WithMockUser`、`@WithUserDetails`、MockMvc 测试受保护接口。


* **44. 生产清单 - 上线前的安全检查 (Checklist)**
* 知识点：HTTPS 强制、Header 安全配置、密钥轮换策略、最小权限原则回顾。


* **45. 终章 - 构建可扩展的统一认证平台总结**
* 知识点：系列回顾、架构总览图、后续学习路线。



---

### 💡 为什么这样调整？

1. **补充了“网关集成 (Gateway)”**：现在的 OAuth2 几乎都是配合微服务的，Gateway 是必考题。
2. **细化了“Token 定制”与“权限映射”**：这是开发者最头疼的地方（怎么把 JWT 里的字段变成代码里的 `hasRole`），单独列出更清晰。
3. **增加了“测试”与“监控”**：这是 Demo 和 生产级代码的分水岭。
4. **拆分了 SAS 和 资源服务器**：逻辑更解耦，先学怎么发证（SAS），再学怎么验均（Resource Server）。

这套目录如果写下来，绝对是全网最硬核且系统的 Spring Security 6 教程之一！准备好开始了吗？




--------------------------------------------











这个要求非常明确且具有实战意义。为了让新手能“先跑通、后深究”，我将目录调整为**“功能驱动型”**结构。

我们将按照：**单体防护实战 -> 前后端分离实战 -> OAuth2 客户端接入 -> 授权服务器搭建 -> 资源服务器保护 -> 高级安全特性 -> 底层原理剖析** 的逻辑编排。

以下是为您优化后的终极实战目录，共 8 个阶段，涵盖了所有核心及补充知识点：

---

### 第一阶段：Spring Security 6 基础防护（快速上手篇）

> **目标**：不谈原理，先让系统拥有最基本的登录和权限控制功能。

**01. 开篇：Hello Security 与环境搭建**

* 1.1 环境要求：JDK 17+、Spring Boot 3.x 配置
* 1.2 引入依赖：快速集成 `spring-boot-starter-security`
* 1.3 默认行为：体验默认登录页与生成的 `user` 密码

**02. 配置新规：Lambda DSL 与安全过滤链**

* 2.1 弃用旧类：为什么不再继承 `WebSecurityConfigurerAdapter`
* 2.2 核心配置：使用 `SecurityFilterChain` Bean 配置授权规则
* 2.3 资源放行：如何正确忽略静态资源与公共接口

**03. 认证实战：连接数据库实现登录**

* 3.1 用户模型：自定义 `UserDetails` 与 `UserDetailsService`
* 3.2 加密选择：`BCryptPasswordEncoder` 与 **Argon2** 编码器配置
* 3.3 密码升级：利用 `UserDetailsPasswordService` 实现**老旧 MD5 密码自动平滑升级**

**04. 页面定制：打造专属登录与注销体验**

* 4.1 UI 集成：自定义 `loginPage`、`loginProcessingUrl` 与参数名
* 4.2 结果处理：自定义登录成功（JSON 响应）与失败处理器
* 4.3 彻底注销：配置 `logout` 清除 Cookie、Session 与自定义逻辑

**05. 权限管理：基于角色与 URL 的控制**

* 5.1 RBAC 模型：`hasRole` 与 `hasAuthority` 的实战区别
* 5.2 方法级授权：开启 `@PreAuthorize` 及其 SpEL 表达式写法
* 5.3 错误响应：自定义“未认证”与“无权限”的 JSON 返回格式

**06. 安全加固：会话、跨域与 CSRF 攻防**

* 6.1 会话管理：实现并发登录限制（踢人下线）与 Session 超时
* 6.2 跨域实战：Security 体系下 **CORS 的正确配置**
* 6.3 CSRF 防御：Token 机制原理及前后端分离下的处理方案

---

### 第二阶段：前后端分离与 JWT 认证（进阶实战篇）

> **目标**：舍弃 Session，实现目前主流的无状态 Token 验证体系。

**07. 架构转型：无状态认证方案设计**

* 7.1 痛点剖析：Session 在集群环境下的局限性
* 7.2 JWT 基础：令牌结构（Header/Payload/Signature）与工具类封装

**08. 过滤器开发：JWT 认证链路集成**

* 8.1 核心组件：编写 `OncePerRequestFilter` 实现令牌解析
* 8.2 上下文构建：手动将认证信息塞入 `SecurityContext`
* 8.3 令牌刷新：前端 **双 Token（Access/Refresh）** 续约方案实现

**09. 多模态登录：集成验证码与手机号登录**

* 9.1 校验增强：在过滤器链中加入图形验证码校验
* 9.2 扩展认证：实现手机验证码登录的自定义 `AuthenticationToken`

---

### 第三阶段：OAuth2 Client 客户端接入（应用篇）

> **目标**：学会“接”别人的认证服务，实现社交登录。

**10. 快速上手：接入 GitHub/Google 第三方登录**

* 10.1 配置驱动：`oauth2-client` 的核心配置文件参数详解
* 10.2 登录流程：体验授权码模式的跳转与回调

**11. 手工实战：不写代码演示授权码模式**

* 11.1 工具调试：使用 Postman 模拟完整的 6 步授权流程
* 11.2 参数解析：理解 `code`、`state` 与回调地址的安全性

---

### 第四阶段：Spring Authorization Server 搭建（核心中心篇）

> **目标**：构建企业级认证中心，成为“发证机关”。

**12. 授权服务器：SAS 开篇与架构全景**

* 12.1 组件选型：Spring Authorization Server (SAS) 核心 Bean 配置
* 12.2 基础启动：配置 JWK Source 与默认的授权端点

**13. 客户端管理：持久化与数据库存储**

* 13.1 数据模型：`RegisteredClient` 详解及 **JdbcRegisteredClientRepository**
* 13.2 动态管理：通过数据库动态增删改查客户端信息

**14. 令牌定制：增强 JWT 内容与密钥管理**

* 14.1 令牌增强：利用 `OAuth2TokenCustomizer` 注入用户业务数据
* 14.2 安全进阶：**密钥轮换（Key Rotation）** 与 JWK Set 暴露

**15. 交互定制：自定义授权与前后端分离**

* 15.1 页面重写：美化授权确认页（Consent Page）
* 15.2 分离方案：SAS 如何配合独立的 Vue/React 认证页面

---

### 第五阶段：OIDC 1.0 与单点登录（身份体系篇）

> **目标**：掌握真正的身份认证标准，实现多系统 SSO。

**16. OIDC 专题：身份令牌 ID Token 详解**

* 16.1 协议补充：为什么 OAuth2 不够？OIDC 带来的身份层
* 16.2 声明实战：自定义 `UserInfo` 端点与身份 Claims

**17. SSO 实战：实现多应用单点登录与登出**

* 17.1 流程整合：多客户端如何共享登录状态
* 17.2 统一注销：实现 **SLO (Single Log Out)** 的不同协议方案

---

### 第六阶段：Resource Server 资源服务器（保护篇）

> **目标**：下游微服务如何守门，验证令牌并提取权限。

**18. 资源服务器：快速集成与 JWT 校验**

* 18.1 接入保护：`oauth2-resource-server` 的配置与签名验证
* 18.2 远程内省：针对不透明令牌（Opaque Token）的远程校验

**19. 鉴权核心：Scope 到 Authority 的映射**

* 19.1 转换秘籍：利用 `JwtAuthenticationConverter` 将 Scope 映射为 Role
* 19.2 精细权限：结合 `hasAuthority` 实现微服务接口的纵深防御

---

### 第七阶段：高级特性与架构演进（专家篇）

> **目标**：解决复杂场景下的安全难题。

**20. 移动端安全：PKCE 模式流程实战**

* 20.1 场景剖析：为什么 App 和单页应用必须开启 PKCE
* 20.2 SAS 配置：强制公共客户端使用 Code Challenge

**21. 令牌交换：Token Exchange (RFC 8693)**

* 21.1 链路安全：微服务 A 调用 B 时如何进行身份置换
* 21.2 落地代码：SAS 中自定义授权模式实现令牌交换

**22. 双向认证：mTLS 客户端认证**

* 22.1 证书校验：基于 X.509 证书的客户端身份识别
* 22.2 令牌绑定：如何将 Access Token 与客户端证书强绑定

**23. 微服务架构：Gateway 网关与响应式安全**

* 23.1 网关鉴权：Spring Cloud Gateway 整合 OAuth2 实现统一入口
* 23.2 令牌中继：`TokenRelay` 机制将令牌透传至下游服务
* 23.3 响应式：WebFlux 下的 `ReactiveSecurityFilterChain` 编程模型

---

### 第八阶段：底层原理与架构剖析（深究篇）

> **目标**：这时候你已经会用了，再回头看原理会恍然大悟。

**24. 过滤器链深度解析：从 Proxy 到 Filter**

* 24.1 源码追踪：`DelegatingFilterProxy` 的初始化与分发逻辑
* 24.2 拦截器顺序：剖析内置 15 个关键过滤器的职责

**25. 认证授权核心：Context 生命周期与决策流**

* 25.1 上下文传播：`SecurityContext` 在多线程与异步环境下的存储原理
* 25.2 决策机制：`AuthenticationManager` 与 `AuthorizationManager` 的源码流转

**26. 终章：生产环境 CheckList 与安全审计**

* 26.1 上线清单：HTTPS 强制、Header 安全头、敏感信息脱敏
* 26.2 监控审计：监听 `AuthenticationSuccessEvent` 实现登录日志追踪

---

### 💡 为什么这样调整？

1. **实战优先**：前三个阶段就能完成 90% 的日常业务需求，让读者快速获得反馈。
2. **补齐遗漏**：增加了 **密钥轮换**、**SSO 统一注销**、**网关集成**、**密码平滑升级** 等原本缺失的企业级知识点。
3. **分层清晰**：将 OAuth2 拆分为 Client、Server、Resource、OIDC 四个独立话题，避免概念混淆。

您觉得这套“先实战后原理”的目录是否更符合您的创作直觉？